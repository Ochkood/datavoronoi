{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/ochirdari/Desktop/datanewsapp/datavoronoi/app/dashboard/posts/page.tsx"],"sourcesContent":["\"use client\"\n\nimport { useEffect, useMemo, useState } from \"react\"\nimport Link from \"next/link\"\nimport Image from \"next/image\"\nimport {\n  Search,\n  PenSquare,\n  MoreHorizontal,\n  Edit,\n  Trash2,\n  Eye,\n  Clock,\n  CheckCircle,\n  XCircle,\n  FileText,\n  Calendar,\n  Heart,\n  MessageCircle,\n  ExternalLink,\n} from \"lucide-react\"\nimport { cn } from \"@/lib/utils\"\nimport { deletePostApi, getMyPosts, type DashboardPost } from \"@/lib/api\"\nimport { getCurrentUser } from \"@/lib/auth\"\n\nconst statusConfig = {\n  published: {\n    label: \"Нийтлэгдсэн\",\n    color: \"bg-chart-4/10 text-chart-4\",\n    icon: CheckCircle,\n  },\n  pending: {\n    label: \"Хүлээгдэж буй\",\n    color: \"bg-chart-5/10 text-chart-5\",\n    icon: Clock,\n  },\n  draft: {\n    label: \"Ноорог\",\n    color: \"bg-muted text-muted-foreground\",\n    icon: FileText,\n  },\n  rejected: {\n    label: \"Татгалзсан\",\n    color: \"bg-destructive/10 text-destructive\",\n    icon: XCircle,\n  },\n}\n\nconst filters = [\"Бүгд\", \"Нийтлэгдсэн\", \"Хүлээгдэж буй\", \"Ноорог\", \"Татгалзсан\"]\nconst filterToStatus: Record<string, string | null> = {\n  \"Бүгд\": null,\n  \"Нийтлэгдсэн\": \"published\",\n  \"Хүлээгдэж буй\": \"pending\",\n  \"Ноорог\": \"draft\",\n  \"Татгалзсан\": \"rejected\",\n}\n\nexport default function MyPostsPage() {\n  const [posts, setPosts] = useState<DashboardPost[]>([])\n  const [searchQuery, setSearchQuery] = useState(\"\")\n  const [activeFilter, setActiveFilter] = useState(\"Бүгд\")\n  const [openMenu, setOpenMenu] = useState<string | null>(null)\n  const [error, setError] = useState(\"\")\n\n  useEffect(() => {\n    const user = getCurrentUser()\n    if (!user?.id) {\n      setPosts([])\n      return\n    }\n\n    getMyPosts(user.id)\n      .then(setPosts)\n      .catch((err) => {\n        setError(err instanceof Error ? err.message : \"Нийтлэл ачаалахад алдаа\")\n      })\n  }, [])\n\n  const filteredPosts = useMemo(() => {\n    return posts.filter((post) => {\n      const matchesSearch = post.title\n        .toLowerCase()\n        .includes(searchQuery.toLowerCase())\n      const matchesFilter =\n        filterToStatus[activeFilter] === null ||\n        post.status === filterToStatus[activeFilter]\n      return matchesSearch && matchesFilter\n    })\n  }, [posts, searchQuery, activeFilter])\n\n  const formatDate = (dateStr: string) => {\n    return new Date(dateStr).toLocaleDateString(\"mn-MN\", {\n      year: \"numeric\",\n      month: \"short\",\n      day: \"numeric\",\n    })\n  }\n\n  const handleDelete = async (id: string) => {\n    if (!confirm(\"Энэ нийтлэлийг устгах уу?\")) return\n    try {\n      await deletePostApi(id)\n      setPosts((prev) => prev.filter((p) => p.id !== id))\n      setOpenMenu(null)\n    } catch (err) {\n      setError(err instanceof Error ? err.message : \"Устгах үед алдаа\")\n    }\n  }\n\n  return (\n    <div className=\"p-6 lg:p-8\">\n      <div className=\"mb-6 flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-foreground\">Миний нийтлэлүүд</h1>\n          <p className=\"mt-1 text-sm text-muted-foreground\">Нийт {posts.length} нийтлэл</p>\n        </div>\n        <Link\n          href=\"/dashboard/posts/new\"\n          className=\"inline-flex items-center justify-center gap-2 rounded-lg bg-primary px-4 py-2.5 text-sm font-medium text-primary-foreground transition-colors hover:bg-primary/90\"\n        >\n          <PenSquare className=\"h-4 w-4\" />\n          Шинэ нийтлэл\n        </Link>\n      </div>\n\n      {error && (\n        <div className=\"mb-4 rounded-lg bg-destructive/10 p-3 text-sm text-destructive\">{error}</div>\n      )}\n\n      <div className=\"mb-6 flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between\">\n        <div className=\"flex flex-wrap gap-2\">\n          {filters.map((filter) => (\n            <button\n              key={filter}\n              onClick={() => setActiveFilter(filter)}\n              className={cn(\n                \"rounded-full px-4 py-1.5 text-sm font-medium transition-colors\",\n                activeFilter === filter\n                  ? \"bg-primary text-primary-foreground\"\n                  : \"bg-secondary text-secondary-foreground hover:bg-secondary/80\"\n              )}\n            >\n              {filter}\n            </button>\n          ))}\n        </div>\n\n        <div className=\"relative\">\n          <Search className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\n          <input\n            type=\"text\"\n            value={searchQuery}\n            onChange={(e) => setSearchQuery(e.target.value)}\n            placeholder=\"Хайх...\"\n            className=\"w-full rounded-lg border border-border bg-card py-2 pl-10 pr-4 text-sm text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring sm:w-64\"\n          />\n        </div>\n      </div>\n\n      <div className=\"rounded-xl border border-border bg-card\">\n        {filteredPosts.length === 0 ? (\n          <div className=\"flex flex-col items-center justify-center py-16\">\n            <FileText className=\"h-12 w-12 text-muted-foreground\" />\n            <p className=\"mt-4 text-lg font-medium text-foreground\">Нийтлэл олдсонгүй</p>\n            <p className=\"mt-1 text-sm text-muted-foreground\">Шүүлтүүрээ өөрчилж эсвэл шинэ нийтлэл үүсгэнэ үү</p>\n          </div>\n        ) : (\n          <div className=\"divide-y divide-border\">\n            {filteredPosts.map((post) => {\n              const status = statusConfig[post.status as keyof typeof statusConfig]\n              return (\n                <div\n                  key={post.id}\n                  className=\"flex items-start gap-4 p-5 transition-colors hover:bg-muted/30\"\n                >\n                  <div className=\"relative h-20 w-32 flex-shrink-0 overflow-hidden rounded-lg\">\n                    <Image src={post.image} alt={post.title} fill className=\"object-cover\" />\n                  </div>\n\n                  <div className=\"flex-1 min-w-0\">\n                    <div className=\"flex items-start justify-between gap-4\">\n                      <div className=\"flex-1 min-w-0\">\n                        <Link href={`/dashboard/posts/${post.id}/edit`} className=\"block\">\n                          <h3 className=\"truncate text-base font-semibold text-foreground hover:text-primary\">\n                            {post.title}\n                          </h3>\n                        </Link>\n                        <p className=\"mt-1 line-clamp-1 text-sm text-muted-foreground\">{post.excerpt}</p>\n                      </div>\n                      <div\n                        className={cn(\n                          \"flex items-center gap-1.5 rounded-full px-2.5 py-1 text-xs font-medium whitespace-nowrap\",\n                          status.color\n                        )}\n                      >\n                        <status.icon className=\"h-3 w-3\" />\n                        {status.label}\n                      </div>\n                    </div>\n\n                    <div className=\"mt-3 flex flex-wrap items-center gap-x-4 gap-y-1 text-xs text-muted-foreground\">\n                      <span className=\"flex items-center gap-1\">\n                        <Calendar className=\"h-3 w-3\" />\n                        {formatDate(post.createdAt)}\n                      </span>\n                      <span className=\"rounded-full bg-secondary px-2 py-0.5\">{post.category}</span>\n                      {post.status === \"published\" && (\n                        <>\n                          <span className=\"flex items-center gap-1\">\n                            <Eye className=\"h-3 w-3\" />\n                            {post.views}\n                          </span>\n                          <span className=\"flex items-center gap-1\">\n                            <Heart className=\"h-3 w-3\" />\n                            {post.likes}\n                          </span>\n                          <span className=\"flex items-center gap-1\">\n                            <MessageCircle className=\"h-3 w-3\" />\n                            {post.comments}\n                          </span>\n                        </>\n                      )}\n                    </div>\n                  </div>\n\n                  <div className=\"relative flex-shrink-0\">\n                    <button\n                      onClick={() => setOpenMenu(openMenu === post.id ? null : post.id)}\n                      className=\"flex h-8 w-8 items-center justify-center rounded-md text-muted-foreground hover:bg-secondary hover:text-foreground\"\n                    >\n                      <MoreHorizontal className=\"h-4 w-4\" />\n                    </button>\n                    {openMenu === post.id && (\n                      <div className=\"absolute right-0 top-full z-10 mt-1 w-44 rounded-lg border border-border bg-card py-1 shadow-lg\">\n                        <Link\n                          href={`/dashboard/posts/${post.id}/edit`}\n                          className=\"flex items-center gap-2 px-3 py-2 text-sm text-foreground hover:bg-muted\"\n                        >\n                          <Edit className=\"h-4 w-4\" />\n                          Засах\n                        </Link>\n                        {post.status === \"published\" && (\n                          <Link\n                            href={`/post/${post.id}`}\n                            target=\"_blank\"\n                            className=\"flex items-center gap-2 px-3 py-2 text-sm text-foreground hover:bg-muted\"\n                          >\n                            <ExternalLink className=\"h-4 w-4\" />\n                            Харах\n                          </Link>\n                        )}\n                        <div className=\"my-1 h-px bg-border\" />\n                        <button\n                          onClick={() => handleDelete(post.id)}\n                          className=\"flex w-full items-center gap-2 px-3 py-2 text-sm text-destructive hover:bg-muted\"\n                        >\n                          <Trash2 className=\"h-4 w-4\" />\n                          Устгах\n                        </button>\n                      </div>\n                    )}\n                  </div>\n                </div>\n              )\n            })}\n          </div>\n        )}\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}}]
}